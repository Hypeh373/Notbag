Вот полный текст страницы о Crypto Pay API:
Crypto Pay API
Обновлено более 4 месяцев назад
Crypto Pay — это платежная система, основанная на Crypto Bot, которая позволяет принимать платежи в криптовалюте и переводить монеты пользователям с помощью нашего API.
Подпишитесь на наш Новостной Канал чтобы первыми узнавать о последних обновлениях и присоединяйтесь к обсуждению в нашем чате.
Недавние изменения
Crypto Pay API 1.5.1 (16 июня 2025 г.)
 * Добавлено поле swap_to к методу createInvoice.
 * Добавлены поля swap_to, is_swapped, swapped_uid, swapped_to, swapped_rate, swapped_output, swapped_usd_rate и swapped_usd_amount к классу Invoice.
Crypto Pay API 1.5 (11 сентября 2024 г.)
 * Добавлено поле spend_id к методу getTransfers и классу Transfer.
Crypto Pay API 1.4 (21 июня 2024 г.)
 * Добавлены поля mini_app_invoice_url, web_app_invoice_url к классу Invoice.
Crypto Pay API 1.3 (15 марта 2024 г.)
 * Добавлена возможность получать статистику приложения, используя метод getStats и класс AppStats.
 * Добавлена возможность создавать чеки с привязкой к пользователю по его ID или юзернейму.
Crypto Pay API 1.2 (24 ноября 2023 г.)
 * Добавлены методы createCheck, deleteCheck, getChecks и класс Check для управления чеками с помощью приложения.
 * Добавлены параметры currency_type, fiat и accepted_assets к методу createInvoice для создания счетов на сумму, указанную в фиатной валюте.
 * Добавлена возможность удалять счета с помощью метода deleteInvoice.
 * Добавлена возможность получать список переводов с помощью метода getTransfers.
 * Добавлены поля currency_type, fiat, paid_asset, paid_amount, paid_usd_rate, paid_fiat_rate, fee_asset, fee_amount и accepted_assets к классу Invoice.
 * Поле fee в полезной нагрузке обновления Webhook теперь устарело, вместо него используйте новое поле fee_amount в классе Invoice.
 * Поле usd_rate в полезной нагрузке обновления Webhook теперь устарело, вместо него используйте новое поле paid_usd_rate в классе Invoice.
 * Поле pay_url теперь устарело, вместо него используйте новое поле bot_invoice_url в классе Invoice.
 * Добавлено поле onhold к классу Balance.
Crypto Pay API 1.1.5 (30 сентября 2023 г.)
 * Прекращена поддержка BUSD.
Crypto Pay API 1.1.4 (22 сентября 2023 г.)
 * Добавлена поддержка LTC в основной сети.
Crypto Pay API 1.1.3 (3 октября 2022 г.)
 * Добавлено поле fee к классу Invoice для отображения суммы взимаемой комиссии за обслуживание. Возвращается только в полезной нагрузке обновления Webhook.
 * Добавлено поле usd_rate к классу Invoice для отображения цены актива в USD. Возвращается только в полезной нагрузке обновления Webhook.
Crypto Pay API 1.1.2 (5 сентября 2022 г.)
 * Метод transfer по умолчанию отключен для новых приложений.
 * Вы можете установить белый список IP-адресов в разделе «Безопасность» в настройках приложения.
Crypto Pay API 1.1.1 (26 июля 2022 г.)
 * Добавлена поддержка ETH в основной сети.
Crypto Pay API 1.1 (2 февраля 2022 г.)
 * Теперь приложения могут отправлять монеты пользователям с помощью нового метода transfer.
 * Добавлена поддержка скрытого сообщения в счетах.
 * Новый параметр expires_in для установки лимита времени оплаты для новых счетов.
 * Добавлено новое поле expiration_date в объекте Invoice.
 * Примечание: Чтобы использовать новый метод transfer, вам необходимо создать новое приложение.
Авторизация вашего приложения
Сначала вам нужно создать новое приложение и получить токен API. Откройте @CryptoBot (@CryptoTestnetBot для тестовой сети), перейдите в Crypto Pay и нажмите «Создать приложение», чтобы получить токен API.
Все запросы к Crypto Pay API должны обслуживаться через HTTPS. Используйте либо строку запроса URL, либо application/json, либо application/x-www-form-urlencoded, либо multipart/form-data для передачи параметров. Токен API должен быть передан в параметре заголовка Crypto-Pay-API-Token. URL должен быть представлен в следующем виде: https://pay.crypt.bot/api/%method%.
Пример запроса:
GET /api/getMe HTTP/1.1
Host: pay.crypt.bot
Crypto-Pay-API-Token: 123456789:AAzQcZWQqQAbsfgPnOLr4FHC8Doa4L7KryC

Тестовая сеть (Testnet):
 * Бот: @CryptoTestnetBot
 * URL: https://testnet-pay.crypt.bot/
Основная сеть (Mainnet):
 * Бот: @CryptoBot
 * URL: https://pay.crypt.bot/
Получение обновлений
Существует два способа получения обновлений для вашего приложения — вы можете использовать метод getInvoices для получения списка созданных счетов или Webhooks для получения обновлений в реальном времени.
Методы
 * getMe
 * createInvoice
 * deleteInvoice
 * createCheck
 * deleteCheck
 * transfer
 * getInvoices
 * getChecks
 * getTransfers
 * getBalance
 * getExchangeRates
 * getCurrencies
 * getStats
Типы
 * Invoice
 * Transfer
 * Check
 * Balance
 * ExchangeRate
 * AppStats
Доступные методы
Мы поддерживаем методы HTTP GET и POST. Ответ содержит JSON-объект, который всегда имеет логическое поле ok. Если ok равно true, запрос был успешным, и результат запроса можно найти в поле result. В случае неудачного запроса ok равно false, а ошибка объясняется в поле error (например, PARAM_SHORT_NAME_REQUIRED). Все запросы должны быть выполнены с использованием UTF-8.
Совет: Используйте Big.js или другую библиотеку для работы с большими числами.
getMe
Используйте этот метод для проверки токена аутентификации вашего приложения. Не требует параметров. В случае успеха возвращает основную информацию о приложении.
createInvoice
Используйте этот метод для создания нового счета. В случае успеха возвращает объект созданного счета.
 * currency_type (String)
   * Необязательно. Тип цены, может быть «crypto» или «fiat». По умолчанию «crypto».
 * asset (String)
   * Необязательно. Требуется, если currency_type — «crypto». Буквенный код криптовалюты. Поддерживаемые активы: “USDT”, “TON”, “BTC”, “ETH”, “LTC”, “BNB”, “TRX” и “USDC”.
 * fiat (String)
   * Необязательно. Требуется, если currency_type — «fiat». Код фиатной валюты. Поддерживаемые фиатные валюты: “USD”, “EUR”, “RUB”, “BYN”, “UAH”, “GBP”, “CNY”, “KZT”, “UZS”, “GEL”, “TRY”, “AMD”, “THB”, “INR”, “BRL”, “IDR”, “AZN”, “AED”, “PLN” и “ILS".
 * accepted_assets (String)
   * Необязательно. Список буквенных кодов криптовалют, разделенных запятыми. Активы, которые могут быть использованы для оплаты счета. Доступно только если currency_type — «fiat». Поддерживаемые активы: “USDT”, “TON”, “BTC”, “ETH”, “LTC”, “BNB”, “TRX” и “USDC” (и “JET” для тестовой сети). По умолчанию — все валюты.
 * amount (String)
   * Сумма счета в формате float. Например: 125.50
 * swap_to (String)
   * Необязательно. Актив, в который будет предпринята попытка обмена после того, как пользователь произведет оплату (обмен не гарантирован). Поддерживаемые активы: "USDT", "TON", "TRX", "ETH", "SOL", "BTC", "LTC".
 * description (String)
   * Необязательно. Описание счета. Пользователь увидит это описание при оплате счета. До 1024 символов.
 * hidden_message (String)
   * Необязательно. Текст сообщения, которое будет показано пользователю после оплаты счета. До 2048 символов.
 * paid_btn_name (String)
   * Необязательно. Название кнопки, которая будет показана пользователю после оплаты счета. Поддерживаемые названия:
     * viewItem – “Посмотреть товар”
     * openChannel – “Открыть канал”
     * openBot – “Открыть бота”
     * callback – “Вернуться”
 * paid_btn_url (String)
   * Необязательно. Требуется, если указано paid_btn_name. URL, открываемый с помощью кнопки, которая будет показана пользователю после оплаты счета. Вы можете установить любую ссылку обратного вызова (например, ссылку на страницу успеха или ссылку на домашнюю страницу). Начинается с https или http.
 * payload (String)
   * Необязательно. Любые данные, которые вы хотите прикрепить к счету (например, ID пользователя, ID платежа и т. д.). До 4 Кб.
 * allow_comments (Boolean)
   * Необязательно. Разрешить пользователю добавлять комментарий к платежу. По умолчанию true.
 * allow_anonymous (Boolean)
   * Необязательно. Разрешить пользователю оплачивать счет анонимно. По умолчанию true.
 * expires_in (Number)
   * Необязательно. Вы можете установить лимит времени оплаты для счета в секундах. Принимаются значения от 1 до 2678400.
deleteInvoice
Используйте этот метод для удаления счетов, созданных вашим приложением. В случае успеха возвращает True.
 * invoice_id (Number)
   * ID счета, который нужно удалить.
createCheck
Используйте этот метод для создания нового чека. В случае успеха возвращает объект созданного чека.
 * asset (String)
   * Буквенный код криптовалюты. Поддерживаемые активы: “USDT”, “TON”, “BTC”, “ETH”, “LTC”, “BNB”, “TRX” и “USDC” (и “JET” для тестовой сети).
 * amount (String)
   * Сумма чека в формате float. Например: 125.50
 * pin_to_user_id (Number)
   * Необязательно. ID пользователя, который сможет активировать чек.
 * pin_to_username (String)
   * Необязательно. Пользователь с указанным юзернеймом сможет активировать чек.
deleteCheck
Используйте этот метод для удаления чеков, созданных вашим приложением. В случае успеха возвращает True.
 * check_id (Number)
   * ID чека, который нужно удалить.
transfer
Используйте этот метод для отправки монет с баланса вашего приложения пользователю. В случае успеха возвращает выполненный перевод. Этот метод должен быть сначала включен в настройках безопасности вашего приложения. Откройте @CryptoBot (@CryptoTestnetBot для тестовой сети), перейдите в Crypto Pay → Мои приложения, выберите приложение, затем перейдите в Безопасность -> Переводы... и нажмите «Включить».
 * user_id (Number)
   * ID пользователя в Telegram. Пользователь должен был ранее использовать @CryptoBot (@CryptoTestnetBot для тестовой сети).
 * asset (String)
   * Буквенный код криптовалюты. Поддерживаемые активы: “USDT”, “TON”, “BTC”, “ETH”, “LTC”, “BNB”, “TRX” и “USDC” (и “JET” для тестовой сети).
 * amount (String)
   * Сумма перевода в формате float. Минимальные и максимальные лимиты сумм для каждого из поддерживаемых активов примерно соответствуют 1-25000 USD. Используйте getExchangeRates для конвертации сумм. Например: 125.50
 * spend_id (String)
   * Случайная строка UTF-8, уникальная для каждого перевода для идемпотентных запросов. Один и тот же spend_id может быть принят только один раз от вашего приложения. До 64 символов.
 * comment (String)
   * Необязательно. Комментарий к переводу. Пользователи увидят этот комментарий в уведомлении о переводе. До 1024 символов.
 * disable_send_notification (Boolean)
   * Необязательно. Передайте true, чтобы не отправлять пользователю уведомление о переводе. По умолчанию false.
getInvoices
Используйте этот метод для получения счетов, созданных вашим приложением. В случае успеха возвращает массив Invoice.
 * asset (String)
   * Необязательно. Буквенный код криптовалюты. Поддерживаемые активы: “USDT”, “TON”, “BTC”, “ETH”, “LTC”, “BNB”, “TRX” и “USDC” (и “JET” для тестовой сети). По умолчанию — все валюты.
 * fiat (String)
   * Необязательно. Код фиатной валюты. Поддерживаемые фиатные валюты: “USD”, “EUR”, “RUB”, “BYN”, “UAH”, “GBP”, “CNY”, “KZT”, “UZS”, “GEL”, “TRY”, “AMD”, “THB”, “INR”, “BRL”, “IDR”, “AZN”, “AED”, “PLN” и “ILS". По умолчанию — все валюты.
 * invoice_ids (String)
   * Необязательно. Список ID счетов, разделенных запятыми.
 * status (String)
   * Необязательно. Статус счетов, которые нужно вернуть. Доступные статусы: “active” (активный) и “paid” (оплаченный). По умолчанию — все статусы.
 * offset (Number)
   * Необязательно. Смещение, необходимое для возврата определенного подмножества счетов. По умолчанию 0.
 * count (Number)
   * Необязательно. Количество счетов, которые нужно вернуть. Принимаются значения от 1 до 1000. По умолчанию 100.
getTransfers
Используйте этот метод для получения переводов, созданных вашим приложением. В случае успеха возвращает массив Transfer.
 * asset (String)
   * Необязательно. Буквенный код криптовалюты. Поддерживаемые активы: “USDT”, “TON”, “BTC”, “ETH”, “LTC”, “BNB”, “TRX” и “USDC” (и “JET” для тестовой сети). По умолчанию — все валюты.
 * transfer_ids (String)
   * Необязательно. Список ID переводов, разделенных запятыми.
 * spend_id (String)
   * Необязательно. Уникальная строка перевода UTF-8.
 * offset (Number)
   * Необязательно. Смещение, необходимое для возврата определенного подмножества переводов. По умолчанию 0.
 * count (Number)
   * Необязательно. Количество переводов, которые нужно вернуть. Принимаются значения от 1 до 1000. По умолчанию 100.
getChecks
Используйте этот метод для получения чеков, созданных вашим приложением. В случае успеха возвращает массив Check.
 * asset (String)
   * Необязательно. Буквенный код криптовалюты. Поддерживаемые активы: “USDT”, “TON”, “BTC”, “ETH”, “LTC”, “BNB”, “TRX” и “USDC” (и “JET” для тестовой сети). По умолчанию — все валюты.
 * check_ids (String)
   * Необязательно. Список ID чеков, разделенных запятыми.
 * status (String)
   * Необязательно. Статус чеков, которые нужно вернуть. Доступные статусы: “active” (активный) и “activated” (активированный). По умолчанию — все статусы.
 * offset (Number)
   * Необязательно. Смещение, необходимое для возврата определенного подмножества чеков. По умолчанию 0.
 * count (Number)
   * Необязательно. Количество чеков, которые нужно вернуть. Принимаются значения от 1 до 1000. По умолчанию 100.
getBalance
Используйте этот метод для получения балансов вашего приложения. Не требует параметров. Возвращает массив Balance.
getExchangeRates
Используйте этот метод для получения обменных курсов поддерживаемых валют. Не требует параметров. Возвращает массив ExchangeRate.
getCurrencies
Используйте этот метод для получения списка поддерживаемых активов. Не требует параметров. Возвращает массив Asset.
getStats
Используйте этот метод, чтобы получить статистику вашего приложения за последние 30 дней. Не требует параметров. Возвращает объект AppStats.
Типы
Invoice
Объект Invoice представляет счет, созданный вашим приложением.
| Поле | Тип | Описание |
|---|---|---|
| invoice_id | Number | Уникальный ID счета. |
| status | String | Текущий статус счета: active или paid. |
| hash | String | Уникальный хеш счета. |
| asset | String | Буквенный код криптовалюты. |
| amount | String | Сумма счета в криптовалюте в формате float. |
| currency_type | String | Тип цены: crypto или fiat. |
| fiat | String | Код фиатной валюты (если currency_type — fiat). |
| accepted_assets | String | Список буквенных кодов криптовалют, разделенных запятыми, которые могут быть использованы для оплаты счета. |
| paid_asset | String | Криптовалюта, которой был оплачен счет. Возвращается, если статус счета paid. |
| paid_amount | String | Сумма, полученная в paid_asset в формате float. Возвращается, если статус счета paid. |
| paid_usd_rate | String | Цена оплаченного актива в USD. Возвращается только в полезной нагрузке обновления Webhook. |
| paid_fiat_rate | String | Цена оплаченного актива в фиате. Возвращается только в полезной нагрузке обновления Webhook. |
| fee_asset | String | Актив комиссии. Возвращается, если статус счета paid. |
| fee_amount | String | Сумма комиссии за обслуживание в fee_asset в формате float. Возвращается, если статус счета paid. |
| bot_invoice_url | String | URL счета в @CryptoBot для оплаты. |
| mini_app_invoice_url | String | URL счета для оплаты в Mini App. |
| web_app_invoice_url | String | URL счета для оплаты в Web App. |
| description | String | Описание счета. |
| hidden_message | String | Скрытое сообщение, которое пользователь увидит после оплаты счета. |
| payload | String | Полезная нагрузка, прикрепленная к счету. |
| allow_comments | Boolean | Разрешены ли комментарии. |
| allow_anonymous | Boolean | Разрешена ли анонимная оплата. |
| is_swapped | Boolean | Был ли платеж обменян на swap_to актив. |
| swapped_uid | Number | ID пользователя (пользователя бота), на который был совершен обмен. |
| swapped_to | String | Актив, на который был совершен обмен. |
| swapped_rate | String | Курс обмена. |
| swapped_output | String | Сумма, полученная после обмена. |
| swapped_usd_rate | String | Цена swapped_to актива в USD. |
| swapped_usd_amount | String | Сумма обмена в USD. |
| created_at | String | Дата создания счета в формате ISO 8601. |
| expiration_date | String | Дата истечения срока действия счета в формате ISO 8601. |
Transfer
Объект Transfer представляет перевод, созданный вашим приложением.
| Поле | Тип | Описание |
|---|---|---|
| transfer_id | Number | Уникальный ID перевода. |
| user_id | Number | ID пользователя в Telegram, которому был отправлен перевод. |
| asset | String | Буквенный код криптовалюты. |
| amount | String | Сумма перевода в формате float. |
| spend_id | String | Уникальный ID запроса (spend_id), использованный при создании перевода. |
| comment | String | Комментарий к переводу. |
| status | String | Текущий статус перевода: completed. |
| completed_at | String | Дата и время завершения перевода в формате ISO 8601. |
Check
Объект Check представляет чек, созданный вашим приложением.
| Поле | Тип | Описание |
|---|---|---|
| check_id | Number | Уникальный ID чека. |
| hash | String | Уникальный хеш чека. |
| asset | String | Буквенный код криптовалюты. |
| amount | String | Сумма чека в формате float. |
| bot_check_url | String | URL чека в @CryptoBot для активации. |
| status | String | Текущий статус чека: active или activated. |
| pin_to_user_id | Number | ID пользователя в Telegram, который может активировать чек. |
| pin_to_username | String | Юзернейм пользователя, который может активировать чек. |
| activated_by_user_id | Number | ID пользователя в Telegram, который активировал чек. Возвращается, если статус чека activated. |
| created_at | String | Дата создания чека в формате ISO 8601. |
| activated_at | String | Дата и время активации чека в формате ISO 8601. Возвращается, если статус чека activated. |
Balance
Объект Balance представляет баланс вашего приложения в определенном активе.
| Поле | Тип | Описание |
|---|---|---|
| asset | String | Буквенный код криптовалюты. |
| available | String | Доступный баланс в формате float. |
| onhold | String | Баланс, находящийся на удержании (например, на инвойсах). |
ExchangeRate
Объект ExchangeRate представляет обменный курс между двумя активами.
| Поле | Тип | Описание |
|---|---|---|
| is_valid | Boolean | Доступен ли обменный курс. |
| source | String | Исходный актив. |
| target | String | Целевой актив. |
| rate | String | Курс обмена в формате float. |
AppStats
Объект AppStats представляет статистику приложения за последние 30 дней.
| Поле | Тип | Описание |
|---|---|---|
| total_invoices | Number | Общее количество созданных счетов. |
| paid_invoices | Number | Количество оплаченных счетов. |
| total_checks | Number | Общее количество созданных чеков. |
| activated_checks | Number | Количество активированных чеков. |
| total_transfers | Number | Общее количество выполненных переводов. |
Webhooks
Webhooks (веб-перехватчики) позволяют вашему приложению получать обновления в реальном времени.
Как включить Webhooks?
Вы можете установить Webhook, используя метод setWebhook.
 * url (String)
   * HTTPS URL для приема обновлений. Максимальная длина URL — 4096 символов.
 * max_connections (Number)
   * Необязательно. Максимально допустимое количество одновременных HTTPS-соединений для доставки обновлений к вашему веб-перехватчику. Принимаются значения от 1 до 100. По умолчанию 40.
Используйте метод deleteWebhook для удаления Webhook, если он больше не нужен. Не требует параметров.
Используйте метод getWebhookInfo для получения текущей информации о Webhook. Не требует параметров. Возвращает объект WebhookInfo.
Объект WebhookInfo
| Поле | Тип | Описание |
|---|---|---|
| url | String | URL, установленный с помощью setWebhook. |
| has_custom_cert | Boolean | True, если для Webhook установлен пользовательский сертификат. |
| pending_update_count | Number | Количество ожидающих обновлений. |
| max_connections | Number | Максимально допустимое количество одновременных HTTPS-соединений. |
| last_error_date | Number | Дата последней ошибки Webhook в формате Unix Time. |
| last_error_message | String | Последнее сообщение об ошибке. |
Обновления Webhook
Каждое обновление представляет собой JSON-объект.
Объект Update
| Поле | Тип | Описание |
|---|---|---|
| update_id | Number | Уникальный ID обновления. |
| type | String | Тип обновления: invoice_paid, transfer_completed, check_activated. |
| payload | Invoice/Transfer/Check | Объект, связанный с обновлением. |
Проверка обновлений Webhook
Вы можете проверить, что обновление Webhook пришло именно от Crypto Pay, проверив заголовок Crypto-Pay-API-Signature.
Сначала вычислите подпись сообщения, используя Hmac-SHA256 с токеном API вашего приложения в качестве ключа и необработанным JSON-обновлением в качестве данных. Затем сравните полученную подпись с подписью в заголовке Crypto-Pay-API-Signature. Если они совпадают, это подтверждает, что обновление пришло от Crypto Pay.
Библиотеки
Список библиотек
Таблица содержания:
 * Недавние изменения
 * Авторизация вашего приложения
 * Тестовая сеть:
 * Основная сеть:
 * Получение обновлений
 * Методы
 * Типы
 * Доступные методы
 * getMe
 * createInvoice
 * deleteInvoice
 * createCheck
 * deleteCheck
 * transfer
 * getInvoices
 * getTransfers
 * getChecks
 * getBalance
 * getExchangeRates
 * getCurrencies
 * getStats
 * Доступные типы
 * Invoice
 * Transfer
 * Check
 * Balance
 * ExchangeRate
 * AppStats
 * Webhooks
 * Как включить Webhooks?
 * Обновления Webhook
 * Проверка обновлений Webhook
 * Библиотеки
